%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% HEADER
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper, twocolumn, oneside, 11pt]{article}

\usepackage{fourier}
\usepackage[T1]{fontenc}

\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{rotating}
\usepackage{pdflscape} 
\usepackage{abstract}
\usepackage[ table ]{ xcolor }
\usepackage[square, comma, sort&compress, longnamesfirst]{natbib} %
\usepackage{subfigure}
\usepackage{setspace}

\setlength{\marginparwidth}{3cm}
\usepackage{todonotes}
%\singlespacing %% 1-spacing (default)s
%\onehalfspacing
\newcommand{\degree}{$^{\circ}$\ }
%%% END Article customizations

%%% The "real" document content comes below...


\title{The saccadic flow baseline: Accounting for image-independent biases in fixation behaviour }

\author{Alasdair D. F. Clarke, Matthew J. Stainer, Ben Tatler \& Amelia R. Hunt}

\begin{document}

\twocolumn[
\maketitle
\begin{onecolabstract}
Much effort has been made to explain eye guidance during natural scene viewing. However, a substantial component of fixation placement appears to be a set of consistent biases in eye movement behaviour. We introduce the concept of \textit{saccadic flow}, a generalisation of the central bias that describes the image-independent conditional probability of making a saccade to $(x_{i+1},y_{i+1})$, given a fixation at $(x_i,y_i)$. We suggest that saccadic flow can be used as a useful prior when carrying out analysis of fixation locations, and can be used as a sub-module in models of eye movements during scene viewing. We demonstrate the utility of this idea by presenting bias-weighted gaze landscapes, and show that there is a link between the likelihood of a saccade under the flow model, and the salience of the following fixation. We also present a minor improvement to our central bias model (based on using a multivariate truncated Gaussian), and investigate the leftwards and coarse-to-fine biases in scene viewing. 
\end{onecolabstract}
]

\input{Introduction}



\section{Modelling Biases}
\label{sec:biases}

In this section, we (i) update the central bias model of \cite{clarke-tatler2014} to make use of a truncated Gaussian distribution that allows us to take the image boundaries into account. (ii) explore the strength of the leftwards bias in relation to the central bias, and (iii) describe the saccadic flow model. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Modelling Methods}
\label{sec:modellingMethods}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Here, we give an overview of the methods and data used for the saccadic flow modelling.

\subsubsection{Datasets}

We will use a number of previously published datasets, covering a range of tasks, images, and experimental set-ups. This allows us to produce a model that will generalise well to other datasets. The models will be trained on eight of the ten datasets used in \cite{clarke-tatler2014}. We chose to remove the data from \cite{asher2013} from our training set as the images have an aspect ratio of 5:4, whereas the rest of the data in our training set has an aspect ratio of 4:3. The pedestrian search dataset \citep{ehinger2009} was removed from the training set as previous analysis \citep{clarke-tatler2014} shows that it is biased compared to the other datasets analysed. Both of these datasets are now used as test sets to evaluate how well our models generalise. 

We also add four new datasets to the ten used by \cite{clarke-tatler2014}. These will be used to test the model. 

\begin{itemize}

\item \cite{jiang2014} collected data from 16 observers viewing 500 natural scenes containing crowds of people (aspect ratio 4:3).

\item \cite{clarke2009} investigated visual search for a target on a homogeneous textured background (i.e. target in noise). This dataset differs from the previous in that there is no semantic image content in the scene, and the stimuli had a 1:1 aspect ratio.

\item \cite{greene-wolfe2012} released a dataset of observers viewing square greyscale photographs.

\item \cite{borji2015} recently released a very large ($\approx 650,000$ fixations, 2000 images) dataset collected over twenty different stimuli types. Given the size of this dataset, and the wide-screen 16:9 aspect ratio, the evaluations on this dataset are presented separately, and split by stimuli class.
s
\end{itemize}
This gives us a relatively homogeneous training test, and a more heterogeneous test set. Hence, good performance on the test sets will likely be indicative of a generalisable result. An overview of the datasets used is given in Appendix Tables \ref{tab:datasets} and \ref{tab:setuptable}. 

\subsubsection{Pre-processing}

As with \cite{clarke-tatler2014}, we normalised all fixations to the image frame, keeping the aspect ratio constant. i.e., $(x,y)\in (-1.-1)\times(-a,a)$ with typically $a=0.75$. The initial saccades after image onset ($9.1\%$ of the data) were excluded, giving us a total of 159,226 saccades. Saccades with a start or end point falling outside of the image frame were also removed. 

When fitting saccadic flow models, we \textit{mirrored} the set of fixations, by adding in horizontally and vertically reflected copies of the data. This has two advantages. (i) It is an easy way to make the saccadic flow bias symmetric in the horizontal or vertical directions. This is similar to how the central bias was defined \cite{clarke-tatler2014}. (ii) It increases the amount of data available for fitting by a factor of four. This is important as (due to the central bias) there are relatively few saccades that originate from the corners of the images. By equating all corners, we can pool the data and obtain more stable estimates for the underlying distribution. The downside of mirroring saccades in this manner is that our model of saccadic flow will be insensitive to the \textit{leftwards} bias in natural scene viewing \citep{nuthmann-matthias2014}. However, as this acocunts for a relatively small proportion of the overall variance in the data (Section \ref{sec:LeftRight}), we view this as an acceptable trade-off. Similarly, as we do not factor in the timecourse of the scanpath, we will not capture \textit{coarse-to-fine} dynamics (saccadic amplitude tends to decrease with time from stimulus onset).


\subsection{Truncated Central Bias}
\label{sec:truncatedCentral}

As the first step in modelling saccadic flow, we will update the central bias from \cite{clarke-tatler2014} and use a truncated normal distribution. This is very straightforward. Re-fitting a multivariate Gaussian to the data reduces the deviance in the central bias model by $4.4\%$. Using a truncated Gaussian gives us an improvement of $12\%$. We can round the truncated Gaussian model to $\mu = (0,0)$, with a covariance matrix of $(0.32, 0; 0, 0.144)$ with no loss of precision. i.e. this is identical to \cite{clarke-tatler2014} except with $\sigma=0.32$ rather than $0.22$.
%why didn't Clarke and Tatler (2014) do this?
\subsection{Left v Right}
\label{sec:LeftRight}

As mentioned above, the downside of mirroring the saccades in our dataset is that our bias model will be symmetric and will be unable to exhibit the leftward bias observed in human fixation data. Here, we investigate the size of the leftwards bias \textbf{(in the unmirrored data)} by plotting how the distribution of horizontal fixation location varies with fixation number (Figure \ref{fig:leftrightDist}). We can see that while we do have a leftwards bias in our data, it is a small effect that only last for the first five fixations after scene onset. Furthermore, there is no sign of an asymmetry in the vertical direction. Fitting an ANOVA to predict the $x$-coordinates of the fixations given the fixation number gives adjusted $R^2=0.004$. If we limit our analysis to the first five fixations in each scanpath, this only increases to adjusted $R^2=0.01$. The small size of the $R^2$ in both instances suggests that \textbf{by ignoring the leftwards bias, we lose little we lose little explanatory power. This brings the advantage of then allowing us to treat everything as symmetrical, which simplifies the model and} increases the amount of data available (by mirroring fixations). 

\begin{figure}
\centering
\subfigure{\includegraphics[width=3.8cm]{../scripts/leftVright/graphs/leftrightbias.pdf}}
\subfigure{\includegraphics[width=3.8cm]{../scripts/leftVright/graphs/updownbias.pdf}}
\caption{Boxplots showing the distribution of horizontal and vertical fixations by fixation number in the merged training set}
\label{fig:leftrightDist}
\end{figure}


\subsection{Saccadic Flow}
\label{ModellingFlow}

Saccadic flow can be thought of as a generalisation of the central bias., and is illustrated in Figure \ref{fig:empiricalSaccadicFlow}. Instead of computing the distribution of all saccadic endpoints in a dataset, we look at the distribution of saccade endpoints given the start points. i.e.,for a saccade from $(x_0, y_0)$ to $(x_1, y_1)$ we want to model $p(x_1,y_1|x_0, y_0)$.

\subsubsection{Modelling}

To characterise how the distribution of saccadic endpoints varies with the start point, we used a sliding window approach. All saccades that originated from a $n\times n$ window were taken and used to fit a truncated multivariate Gaussian distribution using the \texttt{tmvtnorm} library for \texttt{R}. This window was moved in steps of $s=0.01$ from $[-1,-0.75]$ to $[1-n, a-n]$. Windows containing less than 250 datapoints were discarded. We experimented with varying the window size ($n\in\{0.05,0.1, 0.2\}$). However, as this parameter was found to have a negligible result, we only report the results for $n=0.05$.

Multivariate polynomial regression was then used to fit 4-th order polynomials to each of the parameters. As polynomial regression performs poorly in the presence of outliers, we will also use robust estimation (\texttt{rlm} from the \texttt{MASS} library). This will stop the model fits being overly influenced by outlier points from the image boundary. \textbf{Figure \ref{fig:nParamsOverSpace} shows how the parameters for the truncated multivariate Gaussian distributions vary over horizontal position for a selection of vertical positions. The regression coefficients (given in supplementary materials) allow us to estimate the conditional probability of a saccade to $(x_1, y_1)$ given the starting fixation $(x_0, y_0)$. As the robust estimation methods give a far better fit to the data, we will use this version of the model and discard the polynomial regression version.}

\begin{figure*}[ht]
\centering
\includegraphics[width=13cm]{../scripts/flow/figs/NparamsChagingOverSpace_ALL_tN}
\caption{How the truncated Gaussian parameters vary with saccadic starting location. Dotted line show polynomial regression fits, solid line shows robust polynomial regression.}
\label{fig:nParamsOverSpace}
\end{figure*}

\textbf{Evaluation will be done using bootstrapping (10 repetitions with $N=1000$). Not only does  this allow for confidence intervals to be estimated for our result, but it also allows us to sidestep the problems us using datasets of very different sizes: likelihood scores are heavily influenced by the number of points included in the analysis, so having this fixed at $N=1000$ means we can compare across datasets more meaningfully. We chose to evaluate how well the various models work by simply calculating the likelihood, $p(\text{data}|\text{model})$, for each dataset, and reporting the difference in log likelihood between a uniform distribution and our models. As the number of datapoints is much larger than the number of parameters, log likelihood appropriates AIC. We also report an receiver operator curve \citep{green-swets1966} analysis in which we look at how often saccades land within the most likely $x\%$ of the prediction maps from the different bias models.}

\subsubsection{Results}

How well does this model account for the fixations in our datasets? \textbf{Figures \ref{fig:nFlowDevAll} and \ref{fig:nFlowDevBorji} compare how well the different models out perform a uniform distribution in terms of log-likelihood. We can see that in all cases, the flow model offers a much larger improvement over a uniform distribution than either central bias model. The differences between the two central biases is much smaller, but in general, we can see that using a truncated disturbition (to correctly take the image bounderies into account) offers a small improvement over the \cite{clarke-tatler2014} bias.} 

It is interesting to note that \textbf{the flow model still does a good job of accounting for the distribution of saccades in datasets} (those involving visual search) in which the central bias is outperformed (in terms of log-likelihood) by the uniform distribution: chiefly the data from \cite{clarke2009,asher2013,tatler2007}. We can see a very similar pattern of results in the ROC analyis in Figure \ref{fig:nFlowROC}.

\begin{figure}
\centering
\subfigure[][Training datasets]{ \includegraphics[width=7cm]{../scripts/flow/figs/llh_training.pdf}}
\subfigure[][Test datasets]{ \includegraphics[width=7cm]{../scripts/flow/figs/llh_testing.pdf}}
\caption{Modeling results. We can see that the the flow model offers a much larger improvement in terms of log-likelihood than either of the central bias models. This holds even in datasets which do not show a strong central bias.}
\label{fig:nFlowDevAll}
\end{figure}

\begin{figure}
\centering
\subfigure[][Training datasets]{ \includegraphics[width=7cm]{../scripts/flow/figs/llh_training_ROC.pdf}}
\subfigure[][Test datasets]{ \includegraphics[width=7cm]{../scripts/flow/figs/llh_testing_ROC.pdf}}
\caption{ROC analysis for training and tests sets. We can see that in all cases, the flow model outperforms the central bias models.}
\label{fig:nFlowROC}
\end{figure}


\subsubsection{The Effect of Task}

We now examine how the ability of saccadic flow to explain different scanpaths depends on the observers' task. We will make use of datasets from \cite{mills2011} and \cite{koehler2014}. To look at this we computed the mean log likelihood over each scan-path in these datasets (see Figure \ref{fig:taskLLH}). We can see that while task has a slight influence over the mean log likelihood for a scan-path, there is a large degree of overlap in the distributions. Additionally, we can see that the relative likelihood of scan-paths made during visual search compared to other tasks varies between datasets.


\begin{figure*}
\centering
 \subfigure[][]{\includegraphics[width=5cm]{../scripts/inverseYarbus/kLLH.pdf}}
 \subfigure[][]{\includegraphics[width=5cm]{../scripts/inverseYarbus/millsLLH.pdf}}
\caption{The influence of task on the extent to which saccadic flow can explain scan-paths for the (a) \cite{koehler2014} and (b) \cite{mills2011} datasets.}
\label{fig:taskLLH}
\end{figure*}



\input{UsingFlow}

\section{Discussion}

There has been much effort to generate a predictive model of human eye movements \citep{mit-saliency-benchmark,judd2009}. We propose the saccadic flow model as a robust prior for the image-independent saccadic behaviour that is evident when people look at pictures \citep{tatler-vincent2009}. Our Saccadic Flow model provides a better account of eye movement behaviour across 15 published datasets than the original Clarke and Tatler (2014) Central Bias model, and a new version of this model using truncated multivariate normal distributions. We find that Saccadic Flow accounts for eye movements across many different tasks and image types. As saccade probabilities across a scene can be predicted by Saccadic Flow, we therefore provide a method of modelling oculomotor biases that can be included in combined models of eye guidance, much as \cite{torralba2006} and \cite{ehinger2009} use context maps to predict where people will search for people.

\subsection{Using Saccadic Flow}
There are two ways in which models of eye movements may benefit from including such information. First, models may include saccadic flow in their calculation of spatial prediction. Understanding where someone is currently fixating in an image appears to dramatically influence where they will go next; as this saccadic flow can be parametrically estimated from any point on an image, it can be used to weight models of low-level (i.e. visual conspicuity) and high-level (i.e. semantic interest) features. Thus, whether someone fixates one of two equally conspicuous, equally interesting objects may be simply determined by the way that the eyes \textit{tend} to move. 

The second potential utility of saccadic flow is to generate realistic control fixations with which to evaluate observed fixation data. In this way, saccadic flow can be thought of as a partner to the \cite{clarke-tatler2014} central bias, and we expect that in some cases, the simpler central bias will be sufficient (for example, when examining the overall distribution of fixations rather than the sequence of saccades). However we have demonstrated that while the flow model requires more parameters (we use 16 coefficients to track how each of the five truncated Gaussian parameters vary as as a function of $(x,y)$ - although many of them are $\approx 0$), it generalises well from one dataset to another and is a far better baseline for modelling a scan-path than the central bias.

\subsection{Comparisons to existing models}
\citet{tatler-vincent2009} have previously demonstrated that representing saccade probabilities based on the oculomotor biases in eye movements can account for human fixation behaviour during free-viewing reasonably well. Here we extend this concept to spatially adapt the prediction of saccade depending on where in a scene the preceding fixation lies. This is an important step, as it aligns the concept of behavioural biases in eye movement with the central bias \citep{tatler2007}, whereby saccades are likely to be directed towards the centre of the image. An advantage over the simpler central bias of Clarke and Tatler (2014) is that Saccadic Flow does not suppress fixations in the centre of the screen (where interesting content tends to lie), and sets of saccades generated from the Saccadic Flow model will produce the same centrally biased tendencies as observed fixations.

The work presented here improves on recent models by \cite{clarke2016,leMeur-coutrot2016} by offering a parametric model that avoids coarsely partitioning the data into large bins. We have demonstrated that the Saccadic Flow model generalises well to unseen test datasets, although this is only likely to hold for stimuli that are broadly similar to the images used to train the model (photographs of natural and manmade scenes). As we move away from photographic images to stimuli such as computer interfaces, we would expect the Flow model to offer a poor account of the data \citep{leMeur-coutrot2016}. While we have shown that the model performs well over a small range of tasks (free-viewing, scene description, object naming and visual search), we do observe differences in the log-likelihood when different tasks are carried out while viewing the same images. 

\subsection{Limitations of Saccadic Flow}
There are four main limitations to our modelling work. Firstly, by using a truncated Gaussian we are unable to capture the skewed nature of the distribution of saccades originating from the corners (see Figure  \ref{fig:empiricalSaccadicFlow}). We experimented with fitting a skew-normal distribution using the \texttt{sn} package for \texttt{R}, but met with limited success due to having to deal with the image boundaries. We expect this is one of the reasons why our saccadic flow model generates saccades with an average greater amplitudes than those seen in empirical distributions.  The second simplification we make is to not take the leftwards biases in saccadic behaviour. However, our results suggest that this factor has a relatively small effect on saccades, and is important only for the first couple of saccades. Similarly, our model does not take into account coarse-to-fine biases. Across scene viewing, human fixations tend to increase in duration, and saccade amplitudes tend to decrease as the observer's understanding of the image changes \citep{antes1974}. Finally, Saccadic Flow works does not take into account the systematic relationship between successive fixations \citep{tatler2008}. For example, people tend to make consecutive saccades of similar amplitudes, consecutive fixations of similar durations and tend to make movements in the same direction as the previous saccade. 


\subsection{Conclusions}
Behavioural biases in eye movement are prevalent during scene viewing. Our saccadic flow model allows calculation of saccade likelihood across an image based on empirical data of how the eye tends to move in many different scene viewing conditions, with flow providing a strong fit to several datasets. There are a number of ways that flow can be developed, and we propose that gaining a better understanding of the saccadic biases underlying fixation behaviour can only be a positive for our search to understand why people look where they look. Saccadic flow consistently explains more variance than uniform and central bias models. This suggests that our model is robust, generalisable and should be of use to researchers interested in eye movements in a variety of scene-viewing paradigms. 


\section*{Acknowledgements}

And mention grants. 

\section*{Author Contribution}

All authors co-wrote the paper. The saccadic flow model was developed by ADFC. The gaze landscapes and saliency analysis were done by MJS.

\appendix
\input{Dataset}


\section{Analysis of \cite{borji2015} dataset}


\begin{figure*}
\centering
 \includegraphics[width=13cm]{../scripts/flow/figs/llh_Borji.pdf}
\caption{Modeling results for the \cite{borji2015} data. We can see that the the flow model offers a much larger improvement in terms of log-likelihood than either of the central bias models.}
\label{fig:nFlowDevBorji}
\end{figure*}

\bibliographystyle{plainnat}
\small
\bibliography{literature.bib}
\end{document}